#!/usr/bin/env bash

set -e

IMAGE_PATH="$HOME/.cache/wallpaper.png"

cows=( $(cowsay -l| grep -v '^Cow files') )
cow_image=${cows[RANDOM%${#cows[@]}]}
resolution=$(xdpyinfo | awk '/dimensions:/ { print $2 }')

fortune -s |\
  cowsay -f $cow_image |\
  convert \
    -background black \
    -fill grey \
    -font "Fira-Code-Retina-Nerd-Font-Complete-Mono" \
    -size $resolution \
    -gravity center \
    -trim label:@- \
    $IMAGE_PATH

feh --no-fehbg --bg-center $IMAGE_PATH
